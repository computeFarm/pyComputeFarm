---

# This Ansible tasks file describes how to setup a testWorker

- name: Install the runnerLogParser scripts
  template:
    src: runnerLogParser.py.j2
    dest: "{{ ansible_facts.user_dir }}/.local/pyComputeFarm/lib/runnerLogParser-{{item}}.py"
    mode: u=rwx,g=rx,o=rx

- name: Install the runner scripts
  template:
    src: runner.j2
    dest: "{{ ansible_facts.user_dir }}/.local/pyComputeFarm/tmp/runner-{{item}}"
    mode: u=rwx,g=rx,o=rx

- name: Install the testExceptions scripts
  template:
    src: testExceptions.j2
    dest: "{{ ansible_facts.user_dir }}/.local/pyComputeFarm/tmp/testExceptions-{{item}}"
    mode: u=rwx,g=rx,o=rx

- name: Install the testWorker configuration
  template:
    src: runnerConfig.yaml.j2
    dest: "{{ ansible_facts.user_dir }}/.local/pyComputeFarm/config/runnerConfig-{{item}}.yaml"
    mode: u=rwx,g=rx,o=rx

- name: Install the testWorker service
  template:
    src: testWorker.service.j2
    dest: "{{ ansible_facts.user_dir }}/.config/systemd/user/{{ item }}.service"
    mode: u=rw,g=r,o=r